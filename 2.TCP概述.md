# TCP概述

## TCP是面向连接的协议
这就引申出了一个问题，TCP是面向连接的协议，那么是否有无连接协议呢？答案是有的。
- 面向链接(connection-oriented):面向连接的协议要求正式发送数据之前需要通过[握手]的动作来不断验证后建立一个逻辑链接，结束通信时，也是通过有序的四次挥手来断开连接。
- 无连接(connectionless):无连接的协议则不需要。

### 三次握手
建立联系的过程是通过[三次握手]来完成的，顾名思义，通过三次数据交换建立一个连接。通过三次握手协商好双方后续通信的起始序列号、窗口缩放大小等信息。
![avatar](/img/4.png)

### TCP协议是可靠的
- 不可靠：
IP协议不保证包到达的顺序会与它们被传输的顺序一致；   
IP协议不保证包是否重复；
IP协议不保证包是否会达到接收者。
- 可靠：
TCP协议对每个包提供校验和(每个 TCP 包首部中都有两字节用来表示校验和,如果收到一个校验和有差错的报文，TCP 不会发送任何确认直接丢弃它，等待发送端重传。)    
TCP协议包的序列号解决了接收数据的乱序、重复问题(tcp会根据包的大小分两个或多个包进行上传，在每个包中标记他们的序列号,TCP会根据序号进行重新排列，如果因为超时重传了多次，接收端也可以根据包的序号丢弃重复数据，把最终结果传递给上层应用程序。)
TCP协议超时重传(TCP发送数据后会启动一个定时器，等待对端确认收到这个数据包。如果在指定的时间内没有收到ACK确认，就会重传数据包，延长等待时间；多次重传仍失败后，TCP会放弃这个包)
TCP协议流量控制、拥塞控制()

## TCP是面向字节流的协议
TCP是一种字节流协议,流的含义是没有固定报文边界的(传输包的大小、数量不固定，主要取决于诸多因素，路径最大传输单元MTU、发送窗口大小、拥塞窗口大小等)。


## TCP是全双工协议
在TCP中，客户端和服务端可以互为发送端和接收端，每个方向的数据流都独立管理序列号、滑动窗口大小、MSS等信息。


## 总结
TCP是一个可靠的(reliable)、面向连接的(connection-oriented)、基于字节流(byte-stream)、全双工(full-duplex)的协议。发送端在发送数据以后启动一个定时器，如果超时没有收到对端确认会进行重传，接收端利用序列号对收到的包进行排序、丢弃重复数据，TCP还提供了流量控制、拥塞控制点等机制保证了稳定性。